<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Guides</title>
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body>
    <%- include('partials/header') %>

    <div class="gridContainer">
      <!-- Sidebar with Guide Links -->
      <div class="aside">
        <div class="sideNav">
          <ul id="sideNavGrid">
            <% if (guides && guides.length > 0) { %> <% guides.forEach((guide,
            index) => { %>
            <li>
              <a href="/guides/<%= guide._id %>"> <%= guide.tittel %> </a>
            </li>
            <% }) %> <% } else { %>
            <li>No guides available.</li>
            <% } %>
          </ul>
        </div>
      </div>

      <main class="mainContainer">
        <% if (selectedGuide) { %>
        <!-- Display individual guide -->
        <div class="guide">
          <h1><%= selectedGuide.tittel %></h1>
          <p><strong>Tag:</strong> <%= selectedGuide.tag %></p>
          <p><strong>Author:</strong> <%= selectedGuide.author.email %></p>

          <% if (isAuthor) { %>
          <div class="author-actions">
            <a href="/editGuide/<%= selectedGuide._id %>" class="btn btn-edit"
              >Edit Guide</a
            >
            <form
              action="/deleteGuide/<%= selectedGuide._id %>"
              method="POST"
              onsubmit="return confirm('Are you sure you want to delete this guide?');"
            >
              <button type="submit" class="btn btn-delete">Delete Guide</button>
            </form>
          </div>
          <% } %>

          <div class="sectionsContainer">
            <% for (let i = 0; i < selectedGuide.overskrift.length; i++) { %>
            <div class="sectionItem">
              <h2>Section <%= i + 1 %>: <%= selectedGuide.overskrift[i] %></h2>
              <p><%= selectedGuide.beskrivelse[i] %></p>

              <% if (selectedGuide.bilde[i]) { %>
              <img
                src="/uploads/<%= selectedGuide.bilde[i] %>"
                alt="Section Image"
                class="sectionImage"
              />
              <% } %>
            </div>
            <% } %>
          </div>
        </div>
        <% } else { %>
        <!-- Display all guides (optional, or you can show a welcome message) -->
        <h1>Welcome to Guides</h1>
        <p>Please select a guide from the sidebar to view its content.</p>
        <% } %>
      </main>
    </div>
  </body>
</html>
